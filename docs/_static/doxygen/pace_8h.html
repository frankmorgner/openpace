<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenPACE: eac/pace.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenPACE
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_2beb2c8fad66f6564e9cdda73fb11327.html">eac</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">pace.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Interface for Password Authenticated Connection Establishment.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="eac_8h_source.html">eac.h</a>&quot;</code><br />
<code>#include &lt;openssl/bn.h&gt;</code><br />
<code>#include &lt;openssl/buffer.h&gt;</code><br />
</div>
<p><a href="pace_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpace__sec.html">pace_sec</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shared secret for PACE.  <a href="structpace__sec.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:af1f685a647b12b33d20a534195b9dc2b"><td class="memItemLeft" align="right" valign="top"><a id="af1f685a647b12b33d20a534195b9dc2b"></a>
typedef struct <a class="el" href="structpace__sec.html">pace_sec</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pace_8h.html#af1f685a647b12b33d20a534195b9dc2b">PACE_SEC</a></td></tr>
<tr class="memdesc:af1f685a647b12b33d20a534195b9dc2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shared secret for PACE. <br /></td></tr>
<tr class="separator:af1f685a647b12b33d20a534195b9dc2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a02b29cbcf45cfaa2e6df0f59b98b3525"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pace_8h.html#a02b29cbcf45cfaa2e6df0f59b98b3525">s_type</a> { <br />
&#160;&#160;<a class="el" href="pace_8h.html#a02b29cbcf45cfaa2e6df0f59b98b3525a1c7152d3c1a0b7e8543cbf176e38d8f2">PACE_MRZ</a> = 1, 
<a class="el" href="pace_8h.html#a02b29cbcf45cfaa2e6df0f59b98b3525afbbe0ce2ae202cc1837422a10ce487a1">PACE_CAN</a>, 
<a class="el" href="pace_8h.html#a02b29cbcf45cfaa2e6df0f59b98b3525aaf59d2b47ca6bd89c0db0579bc2ede28">PACE_PIN</a>, 
<a class="el" href="pace_8h.html#a02b29cbcf45cfaa2e6df0f59b98b3525a4416853caf39bcbb2a967ba2558d3805">PACE_PUK</a>, 
<br />
&#160;&#160;<a class="el" href="pace_8h.html#a02b29cbcf45cfaa2e6df0f59b98b3525abc55b260a6cc5bdcea0fd496cb847fc4">PACE_RAW</a>, 
<a class="el" href="pace_8h.html#a02b29cbcf45cfaa2e6df0f59b98b3525aa771208f20a5aacab35ddb611ecac21b">PACE_SEC_UNDEF</a>
<br />
 }</td></tr>
<tr class="memdesc:a02b29cbcf45cfaa2e6df0f59b98b3525"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type of the secret.  <a href="pace_8h.html#a02b29cbcf45cfaa2e6df0f59b98b3525">More...</a><br /></td></tr>
<tr class="separator:a02b29cbcf45cfaa2e6df0f59b98b3525"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga434cf93529804c711640461a3930f576"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__management.html#ga434cf93529804c711640461a3930f576">PACE_SEC_clear_free</a> (<a class="el" href="pace_8h.html#af1f685a647b12b33d20a534195b9dc2b">PACE_SEC</a> *s)</td></tr>
<tr class="memdesc:ga434cf93529804c711640461a3930f576"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free a PACE secret.  <a href="group__management.html#ga434cf93529804c711640461a3930f576">More...</a><br /></td></tr>
<tr class="separator:ga434cf93529804c711640461a3930f576"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae35799ea82f5af5420ed100da61fde71"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pace_8h.html#af1f685a647b12b33d20a534195b9dc2b">PACE_SEC</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__management.html#gae35799ea82f5af5420ed100da61fde71">PACE_SEC_new</a> (const char *sec, size_t sec_len, enum <a class="el" href="pace_8h.html#a02b29cbcf45cfaa2e6df0f59b98b3525">s_type</a> type)</td></tr>
<tr class="memdesc:gae35799ea82f5af5420ed100da61fde71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create and initialize a new PACE secret.  <a href="group__management.html#gae35799ea82f5af5420ed100da61fde71">More...</a><br /></td></tr>
<tr class="separator:gae35799ea82f5af5420ed100da61fde71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7a3bae35256a5d00c765d4bc60e2c833"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__management.html#ga7a3bae35256a5d00c765d4bc60e2c833">PACE_SEC_print_private</a> (BIO *out, const <a class="el" href="pace_8h.html#af1f685a647b12b33d20a534195b9dc2b">PACE_SEC</a> *sec, int indent)</td></tr>
<tr class="memdesc:ga7a3bae35256a5d00c765d4bc60e2c833"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print PACE_SEC object including private secret.  <a href="group__management.html#ga7a3bae35256a5d00c765d4bc60e2c833">More...</a><br /></td></tr>
<tr class="separator:ga7a3bae35256a5d00c765d4bc60e2c833"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga275e2d1f7e8cd77f2448ad4fbd09984f"><td class="memItemLeft" align="right" valign="top">BUF_MEM *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__paceproto.html#ga275e2d1f7e8cd77f2448ad4fbd09984f">PACE_STEP1_enc_nonce</a> (const <a class="el" href="eac_8h.html#a75c27f2c580e93611f129c121d5125ec">EAC_CTX</a> *ctx, const <a class="el" href="pace_8h.html#af1f685a647b12b33d20a534195b9dc2b">PACE_SEC</a> *pi)</td></tr>
<tr class="memdesc:ga275e2d1f7e8cd77f2448ad4fbd09984f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates and encrypts a nonce.  <a href="group__paceproto.html#ga275e2d1f7e8cd77f2448ad4fbd09984f">More...</a><br /></td></tr>
<tr class="separator:ga275e2d1f7e8cd77f2448ad4fbd09984f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa46fbd637f3bf063b5c68f37d40efba3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__paceproto.html#gaa46fbd637f3bf063b5c68f37d40efba3">PACE_STEP2_dec_nonce</a> (const <a class="el" href="eac_8h.html#a75c27f2c580e93611f129c121d5125ec">EAC_CTX</a> *ctx, const <a class="el" href="pace_8h.html#af1f685a647b12b33d20a534195b9dc2b">PACE_SEC</a> *pi, const BUF_MEM *enc_nonce)</td></tr>
<tr class="memdesc:gaa46fbd637f3bf063b5c68f37d40efba3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypt the nonce from the other party.  <a href="group__paceproto.html#gaa46fbd637f3bf063b5c68f37d40efba3">More...</a><br /></td></tr>
<tr class="separator:gaa46fbd637f3bf063b5c68f37d40efba3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafd890198805ed2591f172e7815b8a2df"><td class="memItemLeft" align="right" valign="top">BUF_MEM *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__paceproto.html#gafd890198805ed2591f172e7815b8a2df">PACE_STEP3A_generate_mapping_data</a> (const <a class="el" href="eac_8h.html#a75c27f2c580e93611f129c121d5125ec">EAC_CTX</a> *ctx)</td></tr>
<tr class="memdesc:gafd890198805ed2591f172e7815b8a2df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a mapping data to perform the mapping to ephemeral domain parameters.  <a href="group__paceproto.html#gafd890198805ed2591f172e7815b8a2df">More...</a><br /></td></tr>
<tr class="separator:gafd890198805ed2591f172e7815b8a2df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga56c295adbcbca57a6059c04a480d9ff7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__paceproto.html#ga56c295adbcbca57a6059c04a480d9ff7">PACE_STEP3A_map_generator</a> (const <a class="el" href="eac_8h.html#a75c27f2c580e93611f129c121d5125ec">EAC_CTX</a> *ctx, const BUF_MEM *in)</td></tr>
<tr class="memdesc:ga56c295adbcbca57a6059c04a480d9ff7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map to the ephemeral domain parameters.  <a href="group__paceproto.html#ga56c295adbcbca57a6059c04a480d9ff7">More...</a><br /></td></tr>
<tr class="separator:ga56c295adbcbca57a6059c04a480d9ff7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafcb6f32a13e38cb23a82e33faa817179"><td class="memItemLeft" align="right" valign="top">BUF_MEM *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__paceproto.html#gafcb6f32a13e38cb23a82e33faa817179">PACE_STEP3B_generate_ephemeral_key</a> (<a class="el" href="eac_8h.html#a75c27f2c580e93611f129c121d5125ec">EAC_CTX</a> *ctx)</td></tr>
<tr class="memdesc:gafcb6f32a13e38cb23a82e33faa817179"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a keypair for key agreement.  <a href="group__paceproto.html#gafcb6f32a13e38cb23a82e33faa817179">More...</a><br /></td></tr>
<tr class="separator:gafcb6f32a13e38cb23a82e33faa817179"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaee1105d7cbd1fe8629157a3b97f25c52"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__paceproto.html#gaee1105d7cbd1fe8629157a3b97f25c52">PACE_STEP3B_compute_shared_secret</a> (const <a class="el" href="eac_8h.html#a75c27f2c580e93611f129c121d5125ec">EAC_CTX</a> *ctx, const BUF_MEM *in)</td></tr>
<tr class="memdesc:gaee1105d7cbd1fe8629157a3b97f25c52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the shared secret for key agreement.  <a href="group__paceproto.html#gaee1105d7cbd1fe8629157a3b97f25c52">More...</a><br /></td></tr>
<tr class="separator:gaee1105d7cbd1fe8629157a3b97f25c52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae3a44c7269e95f48874dd909ed34ba77"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__paceproto.html#gae3a44c7269e95f48874dd909ed34ba77">PACE_STEP3C_derive_keys</a> (const <a class="el" href="eac_8h.html#a75c27f2c580e93611f129c121d5125ec">EAC_CTX</a> *ctx)</td></tr>
<tr class="memdesc:gae3a44c7269e95f48874dd909ed34ba77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Derives encryption and authentication keys.  <a href="group__paceproto.html#gae3a44c7269e95f48874dd909ed34ba77">More...</a><br /></td></tr>
<tr class="separator:gae3a44c7269e95f48874dd909ed34ba77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf682c5881e60755ef23e4e583e4d7cdd"><td class="memItemLeft" align="right" valign="top">BUF_MEM *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__paceproto.html#gaf682c5881e60755ef23e4e583e4d7cdd">PACE_STEP3D_compute_authentication_token</a> (const <a class="el" href="eac_8h.html#a75c27f2c580e93611f129c121d5125ec">EAC_CTX</a> *ctx, const BUF_MEM *pub)</td></tr>
<tr class="memdesc:gaf682c5881e60755ef23e4e583e4d7cdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the authentication token from domain parameters and public key.  <a href="group__paceproto.html#gaf682c5881e60755ef23e4e583e4d7cdd">More...</a><br /></td></tr>
<tr class="separator:gaf682c5881e60755ef23e4e583e4d7cdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga424f7f098e8377ea602c4f5233a04f3d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__paceproto.html#ga424f7f098e8377ea602c4f5233a04f3d">PACE_STEP3D_verify_authentication_token</a> (const <a class="el" href="eac_8h.html#a75c27f2c580e93611f129c121d5125ec">EAC_CTX</a> *ctx, const BUF_MEM *token)</td></tr>
<tr class="memdesc:ga424f7f098e8377ea602c4f5233a04f3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies an authentication token.  <a href="group__paceproto.html#ga424f7f098e8377ea602c4f5233a04f3d">More...</a><br /></td></tr>
<tr class="separator:ga424f7f098e8377ea602c4f5233a04f3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Interface for Password Authenticated Connection Establishment. </p>
<p>PACE is a protocol used to establish strong session keys based on a weak shared secret (password). The result of a PACE run are two symmetric keys, one for MAC computation and one for encryption. It was specified for Extended Access Control (EAC) in Machine Readable Travel Documents (MRTD), but can also be used for securing any other communication channel. PACE can be used with different suites of algorithms and is not subject to any patents.</p>
<dl class="section author"><dt>Author</dt><dd>Frank Morgner <a href="#" onclick="location.href='mai'+'lto:'+'fra'+'nk'+'mor'+'gn'+'er@'+'gm'+'ail'+'.c'+'om'; return false;">frank<span style="display: none;">.nosp@m.</span>morg<span style="display: none;">.nosp@m.</span>ner@g<span style="display: none;">.nosp@m.</span>mail<span style="display: none;">.nosp@m.</span>.com</a> </dd>
<dd>
Dominik Oepen <a href="#" onclick="location.href='mai'+'lto:'+'oep'+'en'+'@in'+'fo'+'rma'+'ti'+'k.h'+'u-'+'ber'+'li'+'n.d'+'e'; return false;">oepen<span style="display: none;">.nosp@m.</span>@inf<span style="display: none;">.nosp@m.</span>ormat<span style="display: none;">.nosp@m.</span>ik.h<span style="display: none;">.nosp@m.</span>u-ber<span style="display: none;">.nosp@m.</span>lin.<span style="display: none;">.nosp@m.</span>de</a> </dd></dl>

<p class="definition">Definition in file <a class="el" href="pace_8h_source.html">pace.h</a>.</p>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a02b29cbcf45cfaa2e6df0f59b98b3525"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02b29cbcf45cfaa2e6df0f59b98b3525">&#9670;&nbsp;</a></span>s_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="pace_8h.html#a02b29cbcf45cfaa2e6df0f59b98b3525">s_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type of the secret. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a02b29cbcf45cfaa2e6df0f59b98b3525a1c7152d3c1a0b7e8543cbf176e38d8f2"></a>PACE_MRZ&#160;</td><td class="fielddoc"><p>MRZ is the Machine Readable Zone, printed on the card, encoding the personal information of the user. </p>
</td></tr>
<tr><td class="fieldname"><a id="a02b29cbcf45cfaa2e6df0f59b98b3525afbbe0ce2ae202cc1837422a10ce487a1"></a>PACE_CAN&#160;</td><td class="fielddoc"><p>CAN is the Card access number printed on the card. </p>
</td></tr>
<tr><td class="fieldname"><a id="a02b29cbcf45cfaa2e6df0f59b98b3525aaf59d2b47ca6bd89c0db0579bc2ede28"></a>PACE_PIN&#160;</td><td class="fielddoc"><p>PIN is the Personal Identification Number, a secret known only to the user and not printed on the card. </p>
</td></tr>
<tr><td class="fieldname"><a id="a02b29cbcf45cfaa2e6df0f59b98b3525a4416853caf39bcbb2a967ba2558d3805"></a>PACE_PUK&#160;</td><td class="fielddoc"><p>PUK is the Personal Unblocking key. This type of secret is used when the card is suspended due to too many incorrect PACE runs. </p>
</td></tr>
<tr><td class="fieldname"><a id="a02b29cbcf45cfaa2e6df0f59b98b3525abc55b260a6cc5bdcea0fd496cb847fc4"></a>PACE_RAW&#160;</td><td class="fielddoc"><p>This type of secret is not defined in BSI TR-03110. We use it as a generic type, so we can use PACE independent from a ID card. </p>
</td></tr>
<tr><td class="fieldname"><a id="a02b29cbcf45cfaa2e6df0f59b98b3525aa771208f20a5aacab35ddb611ecac21b"></a>PACE_SEC_UNDEF&#160;</td><td class="fielddoc"><p>Undefined type, if nothing else matches. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="pace_8h_source.html#l00067">67</a> of file <a class="el" href="pace_8h_source.html">pace.h</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
